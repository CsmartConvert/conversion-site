---
export const prerender = false;
import Layout from '../../layouts/Layout.astro';

let result = null;

if (Astro.request.method === 'POST') {
  const contentType = Astro.request.headers.get('content-type') || '';
  if (
    contentType.includes('application/x-www-form-urlencoded') ||
    contentType.includes('multipart/form-data')
  ) {
    const data = await Astro.request.formData();
    const totalCost = parseFloat(data.get('totalCost')) || 0;
    const numberOfUnits = parseFloat(data.get('numberOfUnits')) || 1;
    result = totalCost / numberOfUnits;
  }
}
---

<Layout>
  <section class="max-w-md mx-auto p-6 bg-white shadow rounded mt-10">
    <h1 class="text-2xl font-bold mb-4">ðŸ§¾ Price Per Unit Calculator</h1>
    <p class="mb-6 text-gray-600">Find out how much you're paying per item or unitâ€”perfect for grocery comparisons.</p>

    <form method="POST" enctype="application/x-www-form-urlencoded" class="space-y-4">
      <div>
        <label for="totalCost" class="block mb-1 font-medium">Total Cost ($)</label>
        <input type="number" step="0.01" name="totalCost" id="totalCost" required class="w-full p-2 border rounded" />
      </div>
      <div>
        <label for="numberOfUnits" class="block mb-1 font-medium">Number of Units</label>
        <input type="number" step="0.01" name="numberOfUnits" id="numberOfUnits" required class="w-full p-2 border rounded" />
      </div>
      <button type="submit" class="w-full bg-blue-600 text-white px-4 py-2 rounded">Calculate</button>
    </form>

    {result !== null && (
      <p class="mt-6 text-lg font-semibold text-green-700">
        ðŸ’¡ Price Per Unit: ${result.toFixed(2)}
      </p>
    )}
  </section>
</Layout>
