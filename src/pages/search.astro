---
import Layout from '../layouts/Layout.astro';
import tools from '../data/conversion-tools.json';

const url = new URL(Astro.request.url);
const q = url.searchParams.get('q')?.toLowerCase() || '';

const results = q
  ? tools.filter(tool =>
      (tool.title?.toLowerCase()?.includes(q)) ||
      (tool.slug?.toLowerCase()?.includes(q)) ||
      (tool.category?.toLowerCase()?.includes(q)) ||
      (tool.description?.toLowerCase()?.includes(q)) ||
      (Array.isArray(tool.keywords) && tool.keywords.some(kw => kw?.toLowerCase()?.includes(q)))
    )
  : [];
---

<Layout title="Search Results">
  <section class="max-w-4xl mx-auto py-10 px-4">
    <h1 class="text-3xl font-bold mb-6 text-gray-800">Search Results</h1>

    {q ? (
      results.length > 0 ? (
        <ul class="space-y-6">
          {results.map(tool => (
            <li class="bg-white p-4 shadow rounded hover:bg-gray-50 transition">
              <a href={`/tools/${tool.slug}`} class="text-lg text-blue-700 font-semibold hover:underline">
                {tool.title}
              </a>
              <p class="text-sm text-gray-600 mt-1">
                {tool.description || 'No description available.'}
              </p>
            </li>
          ))}
        </ul>
      ) : (
        <p class="text-gray-600 mt-4">No tools found matching <strong>"{q}"</strong>.</p>
      )
    ) : (
      <p class="text-gray-500 mt-4">Please enter a search query above.</p>
    )}
  </section>
</Layout>



